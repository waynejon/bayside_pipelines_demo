version: 1.0.0
services:
  - mysql
ssh-keys:
  git-repo-key:
    secure: 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
events:
  build:
    steps:
      -
        assemble:
          type: script
          script:
            - './assemble.sh'
      -
        acsf:
          type: script
          script:
            - cd docroot
            - drush --include=modules/contrib/acsf/acsf_init acsf-init
      -
        compile:
          type: script
          script:
            - 'npm install less'
            - './node_modules/less/bin/lessc docroot/themes/custom/bayside_theme/less/style.less docroot/themes/custom/bayside_theme/css/style.css'
      - test:
          type: script
          script:
            - 'mysql -u root -proot -e "CREATE DATABASE drupal"'
            - 'cd docroot'
            - '/usr/bin/env PHP_OPTIONS="-d sendmail_path=`which true`" ../bin/drush site-install -y --db-url=mysql://root:root@127.0.0.1:3306/drupal'
            - 'php -S 127.0.0.1:8081 &'
            - 'sleep 4'
            - 'cd ..'
            - ./bin/behat
      -
        post-build:
          type: script
          script:
            - 'chmod u+w docroot/sites/default/settings.php'
            - 'if [ -e "scripts/settings.php" ]; then cp scripts/settings.php docroot/sites/default/settings.php; else cp docroot/sites/default/default.settings.php docroot/sites/default/settings.php; fi' 
variables:
  global:
    EMAIL:
      secure: 2ac4WuWKqzqBaNI/LcrXyBKP17925qKAl93r+oumHK5Sxs9kh0QgoDSHiWK6Y0+gJFT2kCZ81LkS33X2TWP64kIyMKL/vzvgd/sY6Kg/Q0A5Hj4boQs01jH7sMnQGPy2MRQrhlgwFNhFJoeJaAT1CnkUDWL/q7Ej4QGASiOf9E39+zSU7bzTmZEUo6uZaqP2/fauyRqSHGnWq0VtwCy9fb3Sffv9GCofV2JN6rTE6eccl5842POf1iLf1+JSyueZtzgr/QP/jgMDbyzl8fOvlbWBEZUU6M+PUJoM9X0K6p07wGUd/GMmBVzW+GvTdQ9JuI7dxKU+t3JVGXXd62XOA84r3mhe7D8Rn1Tisi+09uS9+NoohzKgzRBqXKqgBg1t9mZVkZiQP2LqVvBA+bze00dMnYIAjn5+UZ5hQqPL1+0sHYW3cB0ARUnEW/m5p/UyzhSJ2xthLS5P+2DE6lDc4p6Daze+DLKUiqMM7Ijuw/C3xSu/quIy/lW/RFfbCu73UZDozUMluwh37qG3Y8d6fQYZ3hm34oLh2/wof+avJvzjjFd8xG5e9g5xGzgqF/CjyEt/Vjw4jeBMTM8qHOCzreAqYR6kaS7C3tXm5gLAid5lTUsd4Ode+jQg6eHMGr7sC5BWHiKpCGmGfYImSN5X5HMh9bb3HIUPrg6XKboH3/BD4U=eW72X/knUQpizhkw2iFLRLM8f6dwi7W44cBs6r96KqE=
    VALIDATION_TOKEN:
      secure: 2acuDn4IYZ3YygDO0z93wlL8EtjNE3esYNPGdCcs7v91WU/IcX2ArCslXDIpH6js4sJ67ixP1pgebGjMd2hVqFj7Xq+dT+CL5kPR3R/UGl6ESbAcf3OcnOpXQ3W9aetRE25IxSbsjIjYrjM4L8h0ASM0dsyHjjJZkPPtR2ADSaa6a+VX06vLob5uS5Pxrip5QnGiW8GGJ4xSeD7gq+CypZYx4IvHTRf2MA72DDuLDuKgCnRiyvulP6VwCRashx/Smb1An5vCtAOgqJg4ktf0yJdgzStgRgcOTqE9diB6wbT8kjlSzZBFrKVLinw6SCUx2Y/BWvZGEh7/bw+98R+sJrE1aGyP1zWGBJhF0sYAzWuYNKxGdXxTeZeuVj7XCHQe85PyjbhcQODjafluWU3utdUwi8BmWiSjA5VrQh4IvLoao1F0j/5rrB7+MJ4iTTK47Wtmet4f0C+jwxjoasntMA3m6nGOawgOg5nwAtf0Ad9PMg7q4rbxlvJPGK7Cdkw0nFfBskGaa/DVuReL8L/IkJgNwPQUaCtTU1DHV0rD2ioKxTttDRvyCwr3Fe/OXCNdgrN1eQewhyShxuqjKNglOd4eucw4OdMTOXQAn4D034Ud5vmTMQgli7PP+9EDvQwQl9zD5p6WKlTFWrEZXK4PQaxu9ExDpLq1ixwxosolBsGVUM=6Mp7SxxS9PRdjt2n+OjpCBBYcIFeULeeG4AxA9H8R0gbbXvwNvuxsspOiRhorrPN
